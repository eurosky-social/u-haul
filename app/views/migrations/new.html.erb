<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eurosky Migration - Start Account Migration</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.6;
      color: #1a1a1a;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .header h1 {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .header p {
      font-size: 16px;
      opacity: 0.95;
    }

    .content {
      padding: 30px;
    }

    .warning-box {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 16px;
      margin-bottom: 24px;
      border-radius: 4px;
    }

    .warning-box h3 {
      color: #856404;
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .warning-box ul {
      color: #856404;
      margin-left: 20px;
      font-size: 14px;
    }

    .warning-box li {
      margin-bottom: 4px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      font-weight: 500;
      margin-bottom: 6px;
      color: #333;
      font-size: 14px;
    }

    input[type="text"],
    input[type="email"],
    input[type="password"] {
      width: 100%;
      padding: 12px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 15px;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="password"]:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .helper-text {
      font-size: 13px;
      color: #6b7280;
      margin-top: 4px;
    }

    .security-note {
      background: #e0f2fe;
      border-left: 4px solid #0284c7;
      padding: 16px;
      margin: 24px 0;
      border-radius: 4px;
    }

    .security-note h3 {
      color: #075985;
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .security-note p {
      color: #075985;
      font-size: 14px;
      line-height: 1.5;
    }

    .submit-button {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .submit-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    .submit-button:active {
      transform: translateY(0);
    }

    .submit-button:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);
    }

    .error-messages {
      background: #fee;
      border-left: 4px solid #dc2626;
      padding: 16px;
      margin-bottom: 24px;
      border-radius: 4px;
    }

    .error-messages h3 {
      color: #991b1b;
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .error-messages ul {
      color: #991b1b;
      margin-left: 20px;
      font-size: 14px;
    }

    .error-messages li {
      margin-bottom: 4px;
    }

    @media (max-width: 640px) {
      body {
        padding: 10px;
      }

      .header {
        padding: 20px;
      }

      .header h1 {
        font-size: 24px;
      }

      .content {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Eurosky Migration</h1>
      <p>Migrate your AT Protocol account to a new PDS</p>
    </div>

    <div class="content">
      <% if @migration&.errors&.any? %>
        <div class="error-messages" role="alert">
          <h3>Please correct the following errors:</h3>
          <ul>
            <% @migration.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="warning-box" role="alert">
        <h3>Important Information</h3>
        <ul>
          <li>This migration will take approximately 20-30 minutes</li>
          <li>Your account will be temporarily unavailable during migration</li>
          <li>You must have access to your old account's password</li>
          <li>You will need a PLC operation token from <a href="https://plc.directory" target="_blank" rel="noopener">plc.directory</a></li>
          <li>Make sure your new PDS is ready to accept your account</li>
        </ul>
      </div>

      <%= form_with model: @migration, url: migrations_path, local: true, html: { novalidate: false } do |f| %>
        <div class="form-group">
          <%= f.label :email, "Email Address" %>
          <%= f.email_field :email, required: true, placeholder: "you@example.com", autocomplete: "email" %>
          <div class="helper-text">We'll send migration status updates to this email</div>
        </div>

        <div class="form-group">
          <%= f.label :old_handle, "Old Handle" %>
          <%= f.text_field :old_handle, required: true, placeholder: "yourhandle.bsky.social", autocomplete: "username" %>
          <div class="helper-text">Your current AT Protocol handle</div>
        </div>

        <div class="form-group">
          <%= f.label :old_pds_host, "Old PDS Host" %>
          <%= f.text_field :old_pds_host, required: true, placeholder: "bsky.social or https://pds.example.com", autocomplete: "url" %>
          <div class="helper-text">The hostname of your current PDS (with or without https://)</div>
        </div>

        <div class="form-group">
          <%= f.label :password, "Account Password" %>
          <%= f.password_field :password, required: true, autocomplete: "current-password" %>
          <div class="helper-text">Your current account password for authentication</div>
        </div>

        <div class="form-group">
          <%= f.label :new_pds_host, "New PDS Host" %>
          <%= f.text_field :new_pds_host, required: true, placeholder: "pds.eurosky.social or https://pds.newhost.com", autocomplete: "url" %>
          <div class="helper-text">The hostname of your destination PDS (with or without https://)</div>
        </div>

        <div class="form-group">
          <%= f.label :new_handle, "New Handle" %>
          <%= f.text_field :new_handle, required: true, placeholder: "yourhandle.eurosky.social", autocomplete: "username" %>
          <div class="helper-text">Your new AT Protocol handle on the destination PDS</div>
        </div>

        <div class="security-note" role="note">
          <h3>Security & Privacy</h3>
          <p>
            Your password is encrypted and stored securely for 48 hours, then automatically deleted.
            It is only used to authenticate with your old PDS during migration.
            We never store or transmit your password in plaintext.
          </p>
        </div>

        <%= f.submit "Start Migration", class: "submit-button", onclick: "return confirm('Are you ready to start the migration? This process will begin immediately and cannot be stopped once started.');" %>
      <% end %>
    </div>
  </div>
</body>
</html>
